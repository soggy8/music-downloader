version: '3.8'

services:
  music-downloader:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: music-downloader
    restart: unless-stopped
    ports:
      - "8000:8000"
    env_file:
      - backend/.env
    volumes:
      # Mount your Navidrome music directory
      # Option 1: If Navidrome is on the host
      - /path/to/your/navidrome/music:/music:rw
      
      # Option 2: If Navidrome is in another Docker container, use named volume
      # volumes:
      #   - navidrome-music:/music:rw
      
      # Downloads directory (temp files)
      - ./downloads:/app/downloads:rw
    environment:
      - API_HOST=0.0.0.0
      - API_PORT=8000
      - NAVIDROME_MUSIC_PATH=/music
      # If Navidrome is on host machine
      - NAVIDROME_API_URL=http://host.docker.internal:4533
      # If Navidrome is in Docker network, use service name
      # - NAVIDROME_API_URL=http://navidrome:4533
    # If Navidrome is in same Docker network, uncomment this:
    # networks:
    #   - music-network
    # external_networks:
    #   - navidrome-network

# volumes:
#   navidrome-music:
#     external: true
#     name: navidrome_music

# networks:
#   music-network:
#     driver: bridge
#   navidrome-network:
#     external: true

